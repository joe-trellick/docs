"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2297],{3905:function(e,n,r){r.d(n,{Zo:function(){return l},kt:function(){return u}});var t=r(67294);function i(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){i(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function a(e,n){if(null==e)return{};var r,t,i=function(e,n){if(null==e)return{};var r,t,i={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(i[r]=e[r]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var p=t.createContext({}),m=function(e){var n=t.useContext(p),r=n;return e&&(r="function"==typeof e?e(n):s(s({},n),e)),r},l=function(e){var n=m(e.components);return t.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},c=t.forwardRef((function(e,n){var r=e.components,i=e.mdxType,o=e.originalType,p=e.parentName,l=a(e,["components","mdxType","originalType","parentName"]),c=m(r),u=i,f=c["".concat(p,".").concat(u)]||c[u]||d[u]||o;return r?t.createElement(f,s(s({ref:n},l),{},{components:r})):t.createElement(f,s({ref:n},l))}));function u(e,n){var r=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=r.length,s=new Array(o);s[0]=c;var a={};for(var p in n)hasOwnProperty.call(n,p)&&(a[p]=n[p]);a.originalType=e,a.mdxType="string"==typeof e?e:i,s[1]=a;for(var m=2;m<o;m++)s[m]=r[m];return t.createElement.apply(null,s)}return t.createElement.apply(null,r)}c.displayName="MDXCreateElement"},48087:function(e,n,r){r.r(n),r.d(n,{frontMatter:function(){return a},contentTitle:function(){return p},metadata:function(){return m},toc:function(){return l},default:function(){return c}});var t=r(87462),i=r(63366),o=(r(67294),r(3905)),s=["components"],a={title:"Android",sidebar_position:2},p="Android Platform Permissions",m={unversionedId:"advanced/platform-permissions/android-platform-permissions",id:"advanced/platform-permissions/android-platform-permissions",isDocsHomePage:!1,title:"Android",description:"The Android operating system restricts access to some of this functionality for the sake of user control and privacy. Therefore, to unlock the full capabilities of Ditto, it is essential to configure your app so that it requests all the permissions that it needs.",source:"@site/docs/advanced/platform-permissions/android-platform-permissions.mdx",sourceDirName:"advanced/platform-permissions",slug:"/advanced/platform-permissions/android-platform-permissions",permalink:"/advanced/platform-permissions/android-platform-permissions",editUrl:"https://github.com/getditto/docs/edit/master/docs/advanced/platform-permissions/android-platform-permissions.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Android",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"iOS",permalink:"/advanced/platform-permissions/ios-platform-permissions"},next:{title:"Conflict-Free Replicated Data Types (CRDTs)",permalink:"/advanced/architecture/crdt"}},l=[],d={toc:l};function c(e){var n=e.components,r=(0,i.Z)(e,s);return(0,o.kt)("wrapper",(0,t.Z)({},d,r,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"android-platform-permissions"},"Android Platform Permissions"),(0,o.kt)("p",null,"The Android operating system restricts access to some of this functionality for the sake of user control and privacy. Therefore, to unlock the full capabilities of Ditto, it is essential to configure your app so that it requests all the permissions that it needs."),(0,o.kt)("p",null,"First, add the following permissions in your app's Manifest.xml file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml",metastring:"title=AndroidManifest.xml",title:"AndroidManifest.xml"},'<uses-permission android:name="android.permission.BLUETOOTH" />\n<uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />\n<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />\n<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />\n<uses-permission android:name="android.permission.INTERNET" />\n<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />\n<uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />\n<uses-permission android:name="android.permission.CHANGE_NETWORK_STATE" />\n<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />\n<uses-permission android:name="android.permission.CHANGE_WIFI_MULTICAST_STATE" />\n')),(0,o.kt)("p",null,"You may notice ",(0,o.kt)("inlineCode",{parentName:"p"},"ACCESS_COARSE_LOCATION")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"ACCESS_FINE_LOCATION"),". This is because ditto does not use the GPS information from the phone, however these two permissions are required to enable Bluetooth Low Energy communication to work correctly."),(0,o.kt)("p",null,"You may need to check if the device allows for the necessary location permissions. The following code is from the example Task app. For more information about requesting permissions in a user-friendly way refer to Android's documentation: ",(0,o.kt)("a",{parentName:"p",href:"https://developer.android.com/training/permissions/requesting"},"Request App Permissions"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},"fun checkLocationPermission() {\n    // On Android, parts of Bluetooth LE and WiFi Direct require location permission\n    // Ditto will operate without it but data sync may be impossible in certain scenarios\n    if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION)\n            != PackageManager.PERMISSION_GRANTED) {\n        // For this app we will prompt the user for this permission every time if it is missing\n        // We ignore the result - Ditto will automatically notice when the permission is granted\n        ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 0);\n    }\n}\n")),(0,o.kt)("p",null,"On Android there may be a noticeable delay between when the user grants location access and when Ditto notices the new permission. For this reason it is recommended to call ",(0,o.kt)("inlineCode",{parentName:"p"},"refreshPermissions()")," whenever a relevant permission might have changed. This will force an immediate check. If a permission has become available your app can begin syncing as quickly as possible."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},"override fun onRequestPermissionsResult(\n    requestCode: Int,\n    permissions: Array<out String>,\n    grantResults: IntArray\n) {\n    super.onRequestPermissionsResult(requestCode, permissions, grantResults)\n    // Regardless of the outcome, tell Ditto that permissions maybe changed\n    ditto?.refreshPermissions()\n}\n")))}c.isMDXComponent=!0}}]);