<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<title data-react-helmet="true">4 - Showing the List of Tasks | Ditto</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.ditto.live/tutorials/tasks/jetpack-compose/tasks-list-screen"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="4 - Showing the List of Tasks | Ditto"><meta data-react-helmet="true" name="description" content="In the last part of the tutorial we referenced a class called TasksListScreen. This screen will show a List using a JetPack Compose Column."><meta data-react-helmet="true" property="og:description" content="In the last part of the tutorial we referenced a class called TasksListScreen. This screen will show a List using a JetPack Compose Column."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.ditto.live/tutorials/tasks/jetpack-compose/tasks-list-screen"><link data-react-helmet="true" rel="alternate" href="https://docs.ditto.live/tutorials/tasks/jetpack-compose/tasks-list-screen" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.ditto.live/tutorials/tasks/jetpack-compose/tasks-list-screen" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.357422d5.css">
<link rel="preload" href="/assets/js/runtime~main.8222efca.js" as="script">
<link rel="preload" href="/assets/js/main.86e2df1a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Ditto</b></a><a href="https://www.ditto.live" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/getditto/samples" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Samples Apps<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/getditto/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Installation</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Tutorials</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Tasks App</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/tasks/index">Intro - Tasks App Tutorial</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">SwiftUI</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Jetpack Compose</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/tasks/jetpack-compose/setup">1 - Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/tasks/jetpack-compose/configure-ditto">2 - Configure Ditto</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/tasks/jetpack-compose/navigation">3 - Navigation</a></li><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tutorials/tasks/jetpack-compose/tasks-list-screen">4 - Showing the List of Tasks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/tasks/jetpack-compose/edit-screen">5 - Editing Tasks</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">UIKit</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">C# Console App</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Security</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advanced</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1>4 - Showing the List of Tasks</h1></header><p>In the last part of the tutorial we referenced a class called <code>TasksListScreen</code>. This screen will show a <code>List&lt;Task&gt;</code> using a JetPack Compose Column.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="4-1-create-a-taskrow-views"></a>4-1 Create a <code>TaskRow</code> views<a class="hash-link" href="#4-1-create-a-taskrow-views" title="Direct link to heading">#</a></h2><p>Each row of the tasks will be represented by a <code>@Composable</code> <code>TaskRow</code> which takes in a <code>Task</code> and two callbacks which we will use later.</p><ol><li>If the <code>task.isCompleted</code> is <code>true</code>, we will show a filled circle icon and a
strike through style for the <code>body</code>. </li><li>If the <code>task.isCompleted</code> is <code>false</code>, we will show a filled circle icon and a strike through style for the <code>body</code>. </li><li>If the user taps the <code>Icon</code>, we will call a <code>onToggle: ((task: Task) -&gt; Unit)?</code>, we will reverse the <code>isCompleted</code> from <code>true</code> to <code>false</code> or <code>false</code> to <code>true</code></li><li>If the user taps the <code>Text</code>, we will call a <code>onClickBody: ((task: Task) -&gt; Unit)?</code>. We will use this to navigate to the <code>EditScreen</code></li></ol><p>For brevity, we will skip discussions on styling as it&#x27;s best to see the code snippet below:</p><p>We&#x27;ve also included included a <code>@Preview</code> <code>TaskRowPreview</code> which allows you to quickly see the end result with some test data.</p><p><img alt="TaskRowPreview" src="/assets/images/task-row-preview-af8072ce125f00667db08e23fa27be28.png"></p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">TaskRow.kt</div><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fun TaskRow(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    task: Task,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    onToggle: ((task: Task) -&gt; Unit)? = null,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    onClickBody: ((task: Task) -&gt; Unit)? = null) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    val iconId =</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (task.isCompleted) R.drawable.ic_baseline_circle_24 else R.drawable.ic_outline_circle_24</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    val color = if (task.isCompleted) R.color.purple_200 else R.color.gray</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    var textDecoration = if (task.isCompleted) TextDecoration.LineThrough else</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        TextDecoration.None</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Row(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Modifier</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .fillMaxWidth()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .padding(12.dp)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Image(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            ImageVector.vectorResource(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                id = iconId</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            ),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Localized description&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            colorFilter = ColorFilter.tint(colorResource(id = color)),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            modifier = Modifier</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                .padding(end = 16.dp)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                .size(24.dp, 24.dp)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                .clickable { onToggleButton?.invoke(task) },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            alignment = Alignment.CenterEnd</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Text(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            text = task.body,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            textDecoration = textDecoration,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            fontSize = 16.sp,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            modifier = Modifier</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                .alignByBaseline()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                .fillMaxWidth()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                .clickable { onClickBody?.invoke(task) })</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Used to preview the code:</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@Preview(showBackground = true)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fun TaskRowPreview() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Column() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        TaskRow(task = Task(UUID.randomUUID().toString(), &quot;Get Milk&quot;, true))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        TaskRow(task = Task(UUID.randomUUID().toString(), &quot;Do Homework&quot;, false))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        TaskRow(task = Task(UUID.randomUUID().toString(), &quot;Take out trash&quot;, true))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="4-2-create-a-composable-tasklist"></a>4-2 Create a <code>@Composable</code> <code>TaskList</code><a class="hash-link" href="#4-2-create-a-composable-tasklist" title="Direct link to heading">#</a></h2><p>Next we will need to show a <code>List&lt;Task&gt;</code> by looping over it and creating a <code>TaskRow</code> for each element. This gives us a scrollable list behavior.</p><ol><li>The <code>TaskList</code> takes in a <code>List&lt;Task&gt;</code> and loops over it in a <code>Column</code> with a <code>.forEach</code> loop.</li><li>Each iteration of the loop will render a <code>Task(task)</code></li><li>We&#x27;ve also added <code>onClickBody</code> and <code>onToggle</code> callback that matches the <code>Task.onClickBody</code> and <code>Task.onToggle</code> functions. </li></ol><p>We&#x27;ve also included a <code>TaskListPreview</code> so that you can add some test data.</p><p><img alt="TaskRowPreview" src="/assets/images/TaskRowPreview-0445fa4c600397ab89c97d9bab6f8415.png"></p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">TaskList.kt</div><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fun TasksList(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    tasks: List&lt;Task&gt;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    onToggle: ((taskId: String) -&gt; Unit)? = null,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    onSelectedTask: ((taskId: String) -&gt; Unit)? = null</span></span><span class="token-line" style="color:#393A34"><span class="token plain">) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Column() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        tasks.forEach { task -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            TaskRow(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                task = task,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                onClickBody = { onSelectedTask?.invoke(it._id) },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                onToggle = { onToggle?.invoke(it._id) }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@Preview(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    showBackground = true,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    showSystemUi = true,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    device = Devices.PIXEL_3</span></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fun TaskListPreview() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    TasksList(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        tasks = listOf(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            Task(UUID.randomUUID().toString(), &quot;Get Milk&quot;, true),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            Task(UUID.randomUUID().toString(), &quot;Get Oats&quot;, false),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            Task(UUID.randomUUID().toString(), &quot;Get Berries&quot;, true),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="4-3-create-a-composable-taskslistscreenviewmodel"></a>4-3 Create a <code>@Composable</code> <code>TasksListScreenViewModel</code><a class="hash-link" href="#4-3-create-a-composable-taskslistscreenviewmodel" title="Direct link to heading">#</a></h2><p>The entire screen&#x27;s data will be completely controlled by a Jetpack Compose <code>ViewModel</code>. The use of <code>ViewModel</code> is a design pattern called <a href="https://proandroiddev.com/architecture-in-jetpack-compose-mvp-mvvm-mvi-17d8170a13fd" target="_blank" rel="noopener noreferrer">MVVM or Model View ViewModel</a> which strives to separate all data manipulation (Model and ViewModel) and data presentation (UI or View) into distinct areas of concern. When it comes to Ditto, we recommend that you never include references to <code>ditto</code> in <code>@Composable</code> types. All interactions with <code>ditto</code> for <code>insert</code>, <code>update</code>, <code>find</code>, <code>remove</code> and <code>observe</code> should be within a <code>ViewModel</code>. </p><ol><li>Now create a new file called <strong>TasksListScreenViewModel.kt</strong> </li><li>Add a property called <code>val tasks: MutableLiveData&lt;List&lt;Task&gt;&gt; = MutableLiveData(emptyList())</code>. This will house all of our tasks that the <code>TasksListScreen</code> can observe for changes. When any <code>MutableLiveData</code> type changes, Jetpack Compose will intelligently tell <code>@Composable</code> types to reload with the necessary changes.</li><li>Create a <code>liveQuery</code> by observing all the tasks documents. Remember our <code>Task</code> data class that we created? We will now map all the <code>DittoDocument</code> to a <code>List&lt;Task&gt;</code> and set them to the tasks.</li><li>Ditto&#x27;s <code>DittoLiveQuery</code> types should be disposed by calling <code>stop()</code> once the <code>ViewModel</code> is no longer necessary. For a simple application, this isn&#x27;t necessary but it&#x27;s always good practice once you start building more complex applications.</li></ol><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">TasksListScreenViewModel.kt</div><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class TasksListScreenViewModel: ViewModel() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    val tasks: MutableLiveData&lt;List&lt;Task&gt;&gt; = MutableLiveData(emptyList())</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    val liveQuery = TasksApplication.ditto!!.store[&quot;tasks&quot;]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .findAll().observe { docs, _ -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            tasks.postValue(docs.map { Task(it) })</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun toggle(taskId: String) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        TasksApplication.ditto!!.store[&quot;tasks&quot;]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .findByID(DittoDocumentID(taskId))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .update { mutableDoc -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                val mutableDoc = mutableDoc?.let { it } ?: return@update</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                mutableDoc[&quot;isCompleted&quot;].set(!mutableDoc[&quot;isCompleted&quot;].booleanValue)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    override fun onCleared() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.onCleared()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        liveQuery.stop()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><a href="https://developer.android.com/jetpack/compose/state#viewmodel-state" target="_blank" rel="noopener noreferrer">You can learn more about ViewModels on the official Android Documentation.</a></p><p>One of the features that we added to the <code>TaskRow</code> is to toggle the <code>isCompleted</code> flag of the document once a user clicks on the circle <code>Icon</code>. We will need to hook this functionality up to edit the Ditto document.</p><p>This <code>toggle</code> function will take the <code>task</code>, find it by it&#x27;s <code>_id</code> and switch it&#x27;s <code>isCompleted</code> value to the opposite value.</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">TasksListScreenViewModel.kt</div><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">// *** </span></span><span class="token-line" style="color:#393A34"><span class="token plain">fun toggle(taskId: String) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    TasksApplication.ditto!!.store[&quot;tasks&quot;]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .findByID(DittoDocumentID(taskId))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .update { mutableDoc -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            val mutableDoc = mutableDoc?.let { it } ?: return@update</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            mutableDoc[&quot;isCompleted&quot;].set(!mutableDoc[&quot;isCompleted&quot;].booleanValue)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Notice that we <em>DO NOT HAVE TO</em> manipulate the <code>tasks</code> value. Calling <code>update</code> will automatically fire the liveQuery to update the <code>tasks</code>. You can always trust the liveQuery to immediately update the <code>val tasks: MutableLiveData&lt;List&lt;Task&gt;&gt;</code>. There is no reason to poll or force reload. Ditto will automatically handle the state changes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="4-4-creating-the-taskslistscreen"></a>4-4 Creating the <code>TasksListScreen</code><a class="hash-link" href="#4-4-creating-the-taskslistscreen" title="Direct link to heading">#</a></h2><p>Finally let&#x27;s create the <code>TasksListScreen</code>. This <code>@Composable</code> is where the <code>navController</code>, <code>TasksListScreenViewModel</code> and <code>TaskList</code> all come together. </p><p>The following code for <code>TasksListScreen</code> is rather small but a lot of things are happening. Follow the steps and look for the appropriate comments that line up to the numbers below:</p><ol><li>The <code>TasksListScreen</code> takes a <code>navController</code> as a parameter. This variable is used to navigate to <code>EditScreen</code> depending on if the user clicks a <code>floatingActionButton</code> or a <code>TasksListScreen.onClickBody</code>. See the <a href="/tutorials/tasks/jetpack-compose/navigation">navigation section for more information on the routes</a></li><li>Create reference to the <code>TasksListScreenViewModel</code> with <code>val tasksListViewModel: TasksListScreenViewModel = viewModel();</code></li><li>Now let&#x27;s tell the <code>@Composable</code> to observe the <code>viewModel.tasks</code> as State object with <code>val tasks: List&lt;Task&gt; by tasksListViewModel.tasks.observeAsState(emptyList())</code>. The syntax <code>by</code> and function <code>observeAsState(emptyList())</code> will tell the <code>@Composable</code> to subscribe to changes. For more <a href="https://developer.android.com/jetpack/compose/state#viewmodel-state" target="_blank" rel="noopener noreferrer">information about <code>observeAsState</code> and <code>ViewModel</code>, click here.</a></li><li>We&#x27;ll add a <code>TopAppBar</code> and <code>ExtendedFloatingActionButton</code> along with our <code>TaskList</code> all wrapped in a <code>Scaffold</code> view. <code>Scaffold</code> are handy ways to layout a more &quot;standard&quot; Android screen. <a href="https://developer.android.com/reference/kotlin/androidx/compose/material/package-summary#Scaffold(androidx.compose.ui.Modifier,androidx.compose.material.ScaffoldState,kotlin.Function0,kotlin.Function0,kotlin.Function1,kotlin.Function0,androidx.compose.material.FabPosition,kotlin.Boolean,kotlin.Function1,kotlin.Boolean,androidx.compose.ui.graphics.Shape,androidx.compose.ui.unit.Dp,androidx.compose.ui.graphics.Color,androidx.compose.ui.graphics.Color,androidx.compose.ui.graphics.Color,androidx.compose.ui.graphics.Color,androidx.compose.ui.graphics.Color,kotlin.Function1)" target="_blank" rel="noopener noreferrer">Learn more about <code>Scaffold</code>s here</a></li><li>Set the <code>ExtendedFloatingActionButton.onClick</code> handler to navigate to the <code>task/edit</code> route of the <code>navController</code></li><li>Use our <code>TaskList</code> inside of the <code>Scaffold.content</code>. Pass the <code>tasks</code> from step 2. into the <code>TaskList</code></li><li>Bind the <code>TaskList.onToggle</code> to the <code>tasksListViewModel.toggle</code></li><li>Bind the <code>TaskList.onClickBody</code> to the <code>navController.navigate(&quot;tasks/edit/${task._id}&quot;)</code>. This will tell the <code>navController</code> to go the <code>EditScreen</code> (we will create this in the next section)</li></ol><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">TasksListScreen.kt</div><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fun TasksListScreen(navController: NavController) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 2.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    val tasksListViewModel: TasksListScreenViewModel = viewModel();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 3.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    val tasks: List&lt;Task&gt; by tasksListViewModel.tasks.observeAsState(emptyList())</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 4.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Scaffold(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        topBar = {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            TopAppBar(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                title = { Text(&quot;Tasks Jetpack Compose&quot;) },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                backgroundColor = colorResource(id = R.color.purple_700)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        floatingActionButton = {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            ExtendedFloatingActionButton(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                icon = { Icon(Icons.Filled.Add, &quot;&quot;) },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                text = { Text(text = &quot;New Task&quot;) },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 5.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                onClick = { navController.navigate(&quot;tasks/edit&quot;) },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                elevation = FloatingActionButtonDefaults.elevation(8.dp)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        floatingActionButtonPosition = FabPosition.End,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        scaffoldState = scaffoldState,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        content = {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            TasksList(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 6</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                tasks = tasks,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 7.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                onToggle = { tasksListViewModel.toggle(it) },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 8.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                onClickBody = { task -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    navController.navigate(&quot;tasks/edit/${task._id}&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="docusaurus-mt-lg"><div class="row"><div class="col"><a href="https://github.com/getditto/docs/edit/master/docs/tutorials/tasks/jetpack-compose/4-tasks-list-screen.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/tutorials/tasks/jetpack-compose/navigation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« 3 - Navigation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/tutorials/tasks/jetpack-compose/edit-screen"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">5 - Editing Tasks Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#4-1-create-a-taskrow-views" class="table-of-contents__link">4-1 Create a <code>TaskRow</code> views</a></li><li><a href="#4-2-create-a-composable-tasklist" class="table-of-contents__link">4-2 Create a <code>@Composable</code> <code>TaskList</code></a></li><li><a href="#4-3-create-a-composable-taskslistscreenviewmodel" class="table-of-contents__link">4-3 Create a <code>@Composable</code> <code>TasksListScreenViewModel</code></a></li><li><a href="#4-4-creating-the-taskslistscreen" class="table-of-contents__link">4-4 Creating the <code>TasksListScreen</code></a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Quick Start</a></li><li class="footer__item"><a href="https://www.ditto.live/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Main Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/getditto/samples" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Samples Apps<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/getditto/docs/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/getditto/docs/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/ditto" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/dittolive" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 DittoLive, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8222efca.js"></script>
<script src="/assets/js/main.86e2df1a.js"></script>
</body>
</html>